{
	"info": {
		"_postman_id": "civictrack-api-collection",
		"name": "CivicTrack API",
		"description": "Complete API collection for CivicTrack Backend",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "civictrack-backend"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"register"
							]
						},
						"description": "Register a new user account"
					},
					"response": []
				},
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\",\n  \"role\": \"citizen\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						},
						"description": "Authenticate user and receive JWT token (stored in cookie)"
					},
					"response": []
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/logout",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"logout"
							]
						},
						"description": "Clear authentication token"
					},
					"response": []
				},
				{
					"name": "Get Current User",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/me",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"me"
							]
						},
						"description": "Get authenticated user information"
					},
					"response": []
				}
			],
			"description": "Authentication endpoints"
		},
		{
			"name": "Admin - Users",
			"item": [
				{
					"name": "List All Users",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							]
						},
						"description": "Get list of all users with their roles (Admin only)"
					},
					"response": []
				},
				{
					"name": "Create User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Jane Doe\",\n  \"email\": \"jane@example.com\",\n  \"password\": \"password123\",\n  \"roleIds\": [1, 3]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							]
						},
						"description": "Create a new user account (Admin only)"
					},
					"response": []
				},
				{
					"name": "Update User",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Jane Smith\",\n  \"email\": \"jane.smith@example.com\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/:userId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								":userId"
							],
							"variable": [
								{
									"key": "userId",
									"value": "1",
									"description": "User ID"
								}
							]
						},
						"description": "Update user information (Admin only)"
					},
					"response": []
				},
				{
					"name": "Update User Roles",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"roleIds\": [1, 2, 3]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/:userId/roles",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								":userId",
								"roles"
							],
							"variable": [
								{
									"key": "userId",
									"value": "1",
									"description": "User ID"
								}
							]
						},
						"description": "Update user roles (Admin only)"
					},
					"response": []
				},
				{
					"name": "Delete User",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/:userId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								":userId"
							],
							"variable": [
								{
									"key": "userId",
									"value": "1",
									"description": "User ID"
								}
							]
						},
						"description": "Soft delete a user (Admin only)"
					},
					"response": []
				}
			],
			"description": "User management endpoints (Admin only)"
		},
		{
			"name": "Admin - Departments",
			"item": [
				{
					"name": "List All Departments",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/departments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"departments"
							]
						},
						"description": "Get list of all departments (Admin only)"
					},
					"response": []
				},
				{
					"name": "Create Department",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Public Works\",\n  \"description\": \"Handles infrastructure and maintenance issues\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/departments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"departments"
							]
						},
						"description": "Create a new department (Admin only)"
					},
					"response": []
				},
				{
					"name": "Update Department",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Public Works & Infrastructure\",\n  \"description\": \"Updated description\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/departments/:departmentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"departments",
								":departmentId"
							],
							"variable": [
								{
									"key": "departmentId",
									"value": "1",
									"description": "Department ID"
								}
							]
						},
						"description": "Update department information (Admin only)"
					},
					"response": []
				},
				{
					"name": "Delete Department",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/departments/:departmentId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"departments",
								":departmentId"
							],
							"variable": [
								{
									"key": "departmentId",
									"value": "1",
									"description": "Department ID"
								}
							]
						},
						"description": "Soft delete a department (Admin only)"
					},
					"response": []
				}
			],
			"description": "Department management endpoints (Admin only)"
		},
		{
			"name": "Admin - Authorities",
			"item": [
				{
					"name": "List All Authorities",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/authorities",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authorities"
							]
						},
						"description": "Get list of all authorities with department information (Admin only)"
					},
					"response": []
				},
				{
					"name": "Create Authority",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"City Hall\",\n  \"city\": \"New York\",\n  \"region\": \"Manhattan\",\n  \"departmentId\": 1,\n  \"address\": \"123 Main St, New York, NY 10001\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/authorities",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authorities"
							]
						},
						"description": "Create a new authority (Admin only)"
					},
					"response": []
				},
				{
					"name": "Update Authority",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"City Hall - Updated\",\n  \"city\": \"New York\",\n  \"region\": \"Manhattan\",\n  \"departmentId\": 2,\n  \"address\": \"Updated address\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/authorities/:authorityId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authorities",
								":authorityId"
							],
							"variable": [
								{
									"key": "authorityId",
									"value": "1",
									"description": "Authority ID"
								}
							]
						},
						"description": "Update authority information (Admin only)"
					},
					"response": []
				},
				{
					"name": "Delete Authority",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/authorities/:authorityId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authorities",
								":authorityId"
							],
							"variable": [
								{
									"key": "authorityId",
									"value": "1",
									"description": "Authority ID"
								}
							]
						},
						"description": "Soft delete an authority (Admin only)"
					},
					"response": []
				}
			],
			"description": "Authority management endpoints (Admin only)"
		},
		{
			"name": "Admin - Authority Users",
			"item": [
				{
					"name": "List All Authority Users",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/authority-users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authority-users"
							]
						},
						"description": "Get list of all authority-user mappings (Admin only)"
					},
					"response": []
				},
				{
					"name": "Create Authority User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"authorityId\": 1,\n  \"userId\": 2\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/authority-users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authority-users"
							]
						},
						"description": "Link a user to an authority (Admin only)"
					},
					"response": []
				},
				{
					"name": "Update Authority User",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"authorityId\": 2\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/authority-users/:authorityUserId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authority-users",
								":authorityUserId"
							],
							"variable": [
								{
									"key": "authorityUserId",
									"value": "1",
									"description": "Authority User ID"
								}
							]
						},
						"description": "Update authority assignment for a user (Admin only)"
					},
					"response": []
				},
				{
					"name": "Delete Authority User",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/authority-users/:authorityUserId",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"authority-users",
								":authorityUserId"
							],
							"variable": [
								{
									"key": "authorityUserId",
									"value": "1",
									"description": "Authority User ID"
								}
							]
						},
						"description": "Remove authority-user link (Admin only)"
					},
					"response": []
				}
			],
			"description": "Authority-User linking endpoints (Admin only)"
		},
		{
			"name": "Issues",
			"item": [
				{
					"name": "List Issue Categories",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/issues/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								"categories"
							]
						},
						"description": "Get list of available issue categories"
					},
					"response": []
				},
				{
					"name": "Create Issue Report",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "title",
									"value": "Pothole on Main Street",
									"type": "text"
								},
								{
									"key": "description",
									"value": "Large pothole causing traffic issues",
									"type": "text"
								},
								{
									"key": "issueId",
									"value": "1",
									"type": "text"
								},
								{
									"key": "authorityId",
									"value": "1",
									"type": "text",
									"disabled": true
								},
								{
									"key": "latitude",
									"value": "40.7128",
									"type": "text",
									"disabled": true
								},
								{
									"key": "longitude",
									"value": "-74.0060",
									"type": "text",
									"disabled": true
								},
								{
									"key": "region",
									"value": "Manhattan",
									"type": "text",
									"disabled": true
								},
								{
									"key": "images",
									"type": "file",
									"src": [],
									"description": "Upload images (max 5, 5MB each)"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/issues/reports",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								"reports"
							]
						},
						"description": "Create a new issue report with optional images (Citizen only)"
					},
					"response": []
				},
				{
					"name": "List Reports",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/issues/reports?status=reported",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								"reports"
							],
							"query": [
								{
									"key": "status",
									"value": "reported",
									"description": "Filter by status (reported, in_progress, resolved)",
									"disabled": true
								},
								{
									"key": "authorityId",
									"value": "1",
									"description": "Filter by authority ID",
									"disabled": true
								}
							]
						},
						"description": "Get list of issue reports (filtered by user role)"
					},
					"response": []
				},
				{
					"name": "Update Issue Status",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"status\": \"in_progress\",\n  \"comment\": \"Work has started on this issue\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/issues/reports/:reportId/status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								"reports",
								":reportId",
								"status"
							],
							"variable": [
								{
									"key": "reportId",
									"value": "1",
									"description": "Report ID"
								}
							]
						},
						"description": "Update the status of an issue report (Authority/Admin only)"
					},
					"response": []
				},
				{
					"name": "Update Issue Status (Alternative)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"status\": \"resolved\",\n  \"comment\": \"Issue has been resolved\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/issues/:id/status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								":id",
								"status"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "Issue ID"
								}
							]
						},
						"description": "Alternative endpoint to update issue status (Authority/Admin only)"
					},
					"response": []
				},
				{
					"name": "Flag Report",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"flagId\": 1\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/issues/reports/:reportId/flag",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								"reports",
								":reportId",
								"flag"
							],
							"variable": [
								{
									"key": "reportId",
									"value": "1",
									"description": "Report ID"
								}
							]
						},
						"description": "Flag an issue report as inappropriate (Citizen only)"
					},
					"response": []
				},
				{
					"name": "List Flagged Reports",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/issues/reports/flagged",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"issues",
								"reports",
								"flagged"
							]
						},
						"description": "Get list of all flagged reports (Admin only)"
					},
					"response": []
				}
			],
			"description": "Issue reporting and management endpoints"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		}
	]
}

